---
title: "Credit Card Fraud Detection using Synthetic data generation"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Libraries
```{r}
library(ggplot2)
library(corrplot)
library(ROSE)
library(rpart)
```
# Credit card dataset
credit card dataset is downloded from kaggle.com.data contains 31 variables namely Time,V1,v2,...V28,Amount,Class and 284,807 observations.data is already scaled using PCA.Data is highly imbalanced that means,there are only 492 fraudulant transcations out of 284807 transactions.

#  Loading dataset
```{r}
data=read.csv("C:\\Users\\AJIT\\Documents\\creditcard.csv")
```
#  Preprocessing
Since data is already scaled so we already prepeared for Exploratory data Analaysis,but before that we will check if there is any missing values. 
```{r}
sum(is.na(data))    ## No Missing data
```
# Exploratory Data analysis
## Know about data
```{r}
str(data)
```
## Discriptive measures
```{r}
summary(data)
```

# Correlation
Since ,data is generated using PCA that means there is no corrleation among them i,e v1,V2,...V28 and this can be verify as below
```{r}
cordata=subset(data,select=-c(Time,Class))
corre=cor(cordata)
corrplot(corre, order = "FPC", method = "color",
         type = "lower", tl.cex = 0.7, tl.col = rgb(0, 0, 0))
```
As,we see ,there is no corrleation. 

## Distribution of Class variable 
given, probelm is binary classification having two class 1 and 0.
```{r}
table(data$Class)
prop.table(table(data$Class))*100
ggplot(data,aes(x=Class))+geom_bar(color="green",fill="red")
ggplot(data, aes(x = Class, y = Amount)) + geom_boxplot(color="blue") +
  ggtitle("Distribution of transaction amount by class")

```
Cleary ,data is highly imbalanced with 492 observation from positive and 284315 from negative class.
# Data Spliting
```{r}
size<- floor(0.75 * nrow(data))
set.seed(123)
train_ind <- sample(seq_len(nrow(data)), size =size)
train <- data[train_ind, ]
test <- data[-train_ind, ]
```
# Methods for Imbalanced Classification Problem
below methods are sampling methods used for imbalanced dataset
## Undersampling
## Oversampling
## Synthetic data generation
## Cost sensitive Learning
here,we use only Synthetic data generation method ,Since this method is robust one than first two methods.
but,before that we will check how model perform without this method.
# Modelling
## Decision tree without sampling method
We will use ROC curve as metrics ,since accuarcy is not good choice while working with imbalanced data classification problem.
```{r}
dt<- rpart(Class~ .,train)
pred<- predict(dt,test)
accuracy.meas(test$Class, pred)
roc.curve(test$Class, pred, plotit = T)
```
## Decision tree with sampling method
In R,there is package called ROSE(Random Over Sapmling Examples) used for implementing sampling method. 
```{r}
data.rose <- ROSE(Class~.,train, seed = 1)$data
table(data.rose$Class)
dt.rose <- rpart(Class ~ .,data.rose)
pred.tree.rose <- predict(dt.rose,test)
roc.curve(test$Class, pred.tree.rose,plotit = T)
```
Clearly sampling method is robust one.